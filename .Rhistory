}
i = 1
for(b in unique_baits[20:27]){
unique_baits_cols[b] = sequential("green", percentage=10)[2+i]
i = i+1
}
library(colortools)
unique_baits = c(paste0("nsp", seq(1,5)), "nsp5_C145A",paste0("nsp", seq(6,15)),
"Spike", "E", "M", "N",
"orf3a", "orf3b", "orf6", "orf7a", "orf7b", "orf8",
"orf9b", "orf9c", "orf10")
unique_baits = paste('SARS-CoV2', unique_baits)
unique_baits = unique_baits[unique_baits%in%PPI_dat$Bait ]
unique_baits_cols = c()
i = 1
for(b in unique_baits[1:15]){
unique_baits_cols[b] = sequential("steelblue", percentage = 6)[i]
i = i + 1
}
i = 1
for(b in unique_baits[16:19]){
unique_baits_cols[b] = sequential("red", percentage = 10)[5+i]
i = i + 1
}
i = 1
for(b in unique_baits[20:27]){
unique_baits_cols[b] = sequential("green", percentage=10)[2+i]
i = i+1
}
baits_withGene_ranks = intersect(as.character(PPI_dat %>% pull(PreyGene)), colnames(PPI_gene_ranks))
PPI_dat = PPI_dat %>% filter(PreyGene %in% baits_withGene_ranks)
PPI_dat = PPI_dat[order(PPI_dat$Bait), ]
PPI_gene_ranks = PPI_gene_ranks[,as.character(PPI_dat %>% pull(PreyGene))]
PPI_gene_ranks_baits = as.character(PPI_dat %>% pull(Bait))
ht_opt(
legend_title_gp = gpar(fontsize = 8, fontface = "bold"),
legend_labels_gp = gpar(fontsize = 8),
heatmap_column_names_gp = gpar(fontsize = 8),
heatmap_column_title_gp = gpar(fontsize = 10),
heatmap_row_title_gp = gpar(fontsize = 8)
)
bait_annotation = HeatmapAnnotation(bait = factor(PPI_gene_ranks_baits, levels = names(unique_baits_cols)),
col = list(bait = unique_baits_cols),
annotation_name_side = "left")
col_fun = colorRamp2(c(1, 25, 39, 49), c('red', 'yellow','cornflowerblue', 'white'))
ht = Heatmap(as.matrix(PPI_gene_ranks),
show_row_names =T,
show_row_dend = F,
show_column_dend = F,
show_column_names = F,
cluster_rows = T,
cluster_columns = F,
col = col_fun,
top_annotation = bait_annotation,
column_title = "SARS-CoV-2 genome components")
ht
factor(PPI_gene_ranks_baits, levels = names(unique_baits_cols))
names(unique_baits_cols)
order(names(unique_baits_cols))
factor(PPI_gene_ranks_baits, levels = names(unique_baits_cols)),
PPI_gene_ranks_baits
names(unique_baits_cols) = factor(names(unique_baits_cols), levels = names(unique_baits_cols))
baits_withGene_ranks = intersect(as.character(PPI_dat %>% pull(PreyGene)), colnames(PPI_gene_ranks))
PPI_dat = PPI_dat %>% filter(PreyGene %in% baits_withGene_ranks)
PPI_dat = PPI_dat[order(PPI_dat$Bait), ]
PPI_gene_ranks = PPI_gene_ranks[,as.character(PPI_dat %>% pull(PreyGene))]
PPI_gene_ranks_baits = as.character(PPI_dat %>% pull(Bait))
ht_opt(
legend_title_gp = gpar(fontsize = 8, fontface = "bold"),
legend_labels_gp = gpar(fontsize = 8),
heatmap_column_names_gp = gpar(fontsize = 8),
heatmap_column_title_gp = gpar(fontsize = 10),
heatmap_row_title_gp = gpar(fontsize = 8)
)
bait_annotation = HeatmapAnnotation(bait = factor(PPI_gene_ranks_baits, levels = names(unique_baits_cols)),
col = list(bait = unique_baits_cols),
annotation_name_side = "left")
col_fun = colorRamp2(c(1, 25, 39, 49), c('red', 'yellow','cornflowerblue', 'white'))
ht = Heatmap(as.matrix(PPI_gene_ranks),
show_row_names =T,
show_row_dend = F,
show_column_dend = F,
show_column_names = F,
cluster_rows = T,
cluster_columns = F,
col = col_fun,
top_annotation = bait_annotation,
column_title = "SARS-CoV-2 genome components")
ht
PPI_gene_ranks_baits
bait_annotation
bait_annotation = HeatmapAnnotation(bait = PPI_gene_ranks_baits,
col = list(bait = unique_baits_cols),
annotation_name_side = "left")
col_fun = colorRamp2(c(1, 25, 39, 49), c('red', 'yellow','cornflowerblue', 'white'))
ht = Heatmap(as.matrix(PPI_gene_ranks),
show_row_names =T,
show_row_dend = F,
show_column_dend = F,
show_column_names = F,
cluster_rows = T,
cluster_columns = F,
col = col_fun,
top_annotation = bait_annotation,
column_title = "SARS-CoV-2 genome components")
ht
unique(PPI_dat$Bait)
PPI_dat = PPI_dat[order(PPI_dat$Bait), ]
unique(PPI_dat$Bait)
PPI_dat$Bait = factor(PPI_dat$Bait, levels = names(unique_baits_cols))
order(PPI_dat$Bait)
PPI_dat = PPI_dat[order(PPI_dat$Bait), ]
PPI_dat$Bait
library(ComplexHeatmap)
library(circlize)
PPI_gene_ranks = read.table('results/PPI_results/Rank_median_in_tissues_corrected_for_COVs.csv', sep = ',',
header = T, stringsAsFactors = F)
PPI_gene_ranks = PPI_gene_ranks[order(rownames(PPI_gene_ranks)), ]
rownames(PPI_gene_ranks) = gtex_col$tissue_id
PPI_gene_ranks = PPI_gene_ranks[tissues_pass_lung,]
datadir_PPI = './PPI_data/'
PPI_dat = read_csv(paste0(datadir_PPI, 'PPI_TableS2.csv'))
library(colortools)
unique_baits = c(paste0("nsp", seq(1,5)), "nsp5_C145A",paste0("nsp", seq(6,15)),
"Spike", "E", "M", "N",
"orf3a", "orf3b", "orf6", "orf7a", "orf7b", "orf8",
"orf9b", "orf9c", "orf10")
unique_baits = paste('SARS-CoV2', unique_baits)
unique_baits = unique_baits[unique_baits%in%PPI_dat$Bait ]
unique_baits_cols = c()
i = 1
for(b in unique_baits[1:15]){
unique_baits_cols[b] = sequential("steelblue", percentage = 6)[i]
i = i + 1
}
i = 1
for(b in unique_baits[16:19]){
unique_baits_cols[b] = sequential("red", percentage = 10)[5+i]
i = i + 1
}
i = 1
for(b in unique_baits[20:27]){
unique_baits_cols[b] = sequential("green", percentage=10)[2+i]
i = i+1
}
baits_withGene_ranks = intersect(as.character(PPI_dat %>% pull(PreyGene)), colnames(PPI_gene_ranks))
PPI_dat = PPI_dat %>% filter(PreyGene %in% baits_withGene_ranks)
PPI_dat$Bait = factor(PPI_dat$Bait, levels = names(unique_baits_cols))
PPI_dat = PPI_dat[order(PPI_dat$Bait), ]
PPI_gene_ranks = PPI_gene_ranks[,as.character(PPI_dat %>% pull(PreyGene))]
PPI_gene_ranks_baits = as.character(PPI_dat %>% pull(Bait))
ht_opt(
legend_title_gp = gpar(fontsize = 8, fontface = "bold"),
legend_labels_gp = gpar(fontsize = 8),
heatmap_column_names_gp = gpar(fontsize = 8),
heatmap_column_title_gp = gpar(fontsize = 10),
heatmap_row_title_gp = gpar(fontsize = 8)
)
bait_annotation = HeatmapAnnotation(bait = PPI_gene_ranks_baits,
col = list(bait = unique_baits_cols),
annotation_name_side = "left")
col_fun = colorRamp2(c(1, 25, 39, 49), c('red', 'yellow','cornflowerblue', 'white'))
ht = Heatmap(as.matrix(PPI_gene_ranks),
show_row_names =T,
show_row_dend = F,
show_column_dend = F,
show_column_names = F,
cluster_rows = T,
cluster_columns = F,
col = col_fun,
top_annotation = bait_annotation,
column_title = "SARS-CoV-2 genome components")
ht
library(colortools)
unique_baits = c(paste0("nsp", seq(1,5)), "nsp5_C145A",paste0("nsp", seq(6,15)),
"Spike", "E", "M", "N",
"orf3a", "orf3b", "orf6", "orf7a", "orf7b", "orf8",
"orf9b", "orf9c", "orf10")
unique_baits = paste('SARS-CoV2', unique_baits)
unique_baits = unique_baits[unique_baits%in%PPI_dat$Bait ]
unique_baits_cols = c()
i = 1
for(b in unique_baits[1:15]){
unique_baits_cols[b] = sequential("steelblue", percentage = 6)[i]
i = i + 1
}
i = 1
for(b in unique_baits[16:19]){
unique_baits_cols[b] = sequential("red", percentage = 10)[5+i]
i = i + 1
}
i = 1
for(b in unique_baits[20:27]){
unique_baits_cols[b] = sequential("green", percentage=10)[2+i]
i = i+1
}
?sequential
unique_baits_cols = c()
i = 1
for(b in unique_baits[1:15]){
unique_baits_cols[b] = sequential("steelblue", percentage = 6, plot=F)[i]
i = i + 1
}
i = 1
for(b in unique_baits[16:19]){
unique_baits_cols[b] = sequential("red", percentage = 10, plot=F)[5+i]
i = i + 1
}
i = 1
for(b in unique_baits[20:27]){
unique_baits_cols[b] = sequential("green", percentage=10, plot=F)[2+i]
i = i+1
}
baits_withGene_ranks = intersect(as.character(PPI_dat %>% pull(PreyGene)), colnames(PPI_gene_ranks))
baits_withGene_ranks
PPI_dat = PPI_dat %>% filter(PreyGene %in% baits_withGene_ranks)
PPI_dat$Bait = factor(PPI_dat$Bait, levels = names(unique_baits_cols))
order(PPI_dat$Bait)
names(unique_baits_cols)
PPI_dat = PPI_dat[order(PPI_dat$Bait), ]
PPI_gene_ranks = PPI_gene_ranks[,as.character(PPI_dat %>% pull(PreyGene))]
PPI_gene_ranks_baits = as.character(PPI_dat %>% pull(Bait))
PPI_dat$Bait
library(colortools)
unique_baits = c(paste0("nsp", seq(1,5)), "nsp5_C145A",paste0("nsp", seq(6,15)),
"E", "M", "N",
"orf3a", "orf3b", "orf6", "orf7a", "orf7b", "orf8",
"orf9b", "orf9c", "orf10")
unique_baits = paste('SARS-CoV2', unique_baits)
unique_baits = unique_baits[unique_baits%in%PPI_dat$Bait ]
unique_baits_cols = c()
i = 1
for(b in unique_baits[1:15]){
unique_baits_cols[b] = sequential("steelblue", percentage = 6, plot=F)[i]
i = i + 1
}
i = 1
for(b in unique_baits[16:19]){
unique_baits_cols[b] = sequential("red", percentage = 10, plot=F)[5+i]
i = i + 1
}
i = 1
for(b in unique_baits[20:27]){
unique_baits_cols[b] = sequential("green", percentage=10, plot=F)[2+i]
i = i+1
}
baits_withGene_ranks = intersect(as.character(PPI_dat %>% pull(PreyGene)), colnames(PPI_gene_ranks))
PPI_dat = PPI_dat %>% filter(PreyGene %in% baits_withGene_ranks)
PPI_dat$Bait = factor(PPI_dat$Bait, levels = names(unique_baits_cols))
PPI_dat = PPI_dat[order(PPI_dat$Bait), ]
PPI_gene_ranks = PPI_gene_ranks[,as.character(PPI_dat %>% pull(PreyGene))]
PPI_gene_ranks_baits = as.character(PPI_dat %>% pull(Bait))
ht_opt(
legend_title_gp = gpar(fontsize = 8, fontface = "bold"),
legend_labels_gp = gpar(fontsize = 8),
heatmap_column_names_gp = gpar(fontsize = 8),
heatmap_column_title_gp = gpar(fontsize = 10),
heatmap_row_title_gp = gpar(fontsize = 8)
)
bait_annotation = HeatmapAnnotation(bait = PPI_gene_ranks_baits,
col = list(bait = unique_baits_cols),
annotation_name_side = "left")
col_fun = colorRamp2(c(1, 25, 39, 49), c('red', 'yellow','cornflowerblue', 'white'))
ht = Heatmap(as.matrix(PPI_gene_ranks),
show_row_names =T,
show_row_dend = F,
show_column_dend = F,
show_column_names = F,
cluster_rows = T,
cluster_columns = F,
col = col_fun,
top_annotation = bait_annotation,
column_title = "SARS-CoV-2 genome components")
ht
unique_baits_cols
datadir_PPI = './PPI_data/'
PPI_dat = read_csv(paste0(datadir_PPI, 'PPI_TableS2.csv'))
library(colortools)
unique_baits = c(paste0("nsp", seq(1,5)), "nsp5_C145A",paste0("nsp", seq(6,15)),
"E", "M", "N",
"orf3a", "orf3b", "orf6", "orf7a", "orf7b", "orf8",
"orf9b", "orf9c", "orf10")
unique_baits = paste('SARS-CoV2', unique_baits)
unique_baits = unique_baits[unique_baits%in%PPI_dat$Bait ]
unique_baits_cols = c()
i = 1
for(b in unique_baits[1:15]){
unique_baits_cols[b] = sequential("steelblue", percentage = 6, plot=F)[i]
i = i + 1
}
i = 1
for(b in unique_baits[16:18]){
unique_baits_cols[b] = sequential("red", percentage = 10, plot=F)[5+i]
i = i + 1
}
i = 1
for(b in unique_baits[19:26]){
unique_baits_cols[b] = sequential("green", percentage=10, plot=F)[2+i]
i = i+1
}
baits_withGene_ranks = intersect(as.character(PPI_dat %>% pull(PreyGene)), colnames(PPI_gene_ranks))
PPI_dat = PPI_dat %>% filter(PreyGene %in% baits_withGene_ranks)
PPI_dat$Bait = factor(PPI_dat$Bait, levels = names(unique_baits_cols))
PPI_dat = PPI_dat[order(PPI_dat$Bait), ]
PPI_gene_ranks = PPI_gene_ranks[,as.character(PPI_dat %>% pull(PreyGene))]
PPI_gene_ranks_baits = as.character(PPI_dat %>% pull(Bait))
ht_opt(
legend_title_gp = gpar(fontsize = 8, fontface = "bold"),
legend_labels_gp = gpar(fontsize = 8),
heatmap_column_names_gp = gpar(fontsize = 8),
heatmap_column_title_gp = gpar(fontsize = 10),
heatmap_row_title_gp = gpar(fontsize = 8)
)
bait_annotation = HeatmapAnnotation(bait = PPI_gene_ranks_baits,
col = list(bait = unique_baits_cols),
annotation_name_side = "left")
col_fun = colorRamp2(c(1, 25, 39, 49), c('red', 'yellow','cornflowerblue', 'white'))
ht = Heatmap(as.matrix(PPI_gene_ranks),
show_row_names =T,
show_row_dend = F,
show_column_dend = F,
show_column_names = F,
cluster_rows = T,
cluster_columns = F,
col = col_fun,
top_annotation = bait_annotation,
column_title = "SARS-CoV-2 genome components")
ht
PPI_gene_ranks_baits
library(ComplexHeatmap)
library(circlize)
PPI_gene_ranks = read.table('results/PPI_results/Rank_median_in_tissues_corrected_for_COVs.csv', sep = ',',
header = T, stringsAsFactors = F)
PPI_gene_ranks = PPI_gene_ranks[order(rownames(PPI_gene_ranks)), ]
rownames(PPI_gene_ranks) = gtex_col$tissue_id
PPI_gene_ranks = PPI_gene_ranks[tissues_pass_lung,]
datadir_PPI = './PPI_data/'
PPI_dat = read_csv(paste0(datadir_PPI, 'PPI_TableS2.csv'))
library(colortools)
unique_baits = c(paste0("nsp", seq(1,5)), "nsp5_C145A",paste0("nsp", seq(6,15)),
"E", "M", "N",
"orf3a", "orf3b", "orf6", "orf7a", "orf7b", "orf8",
"orf9b", "orf9c", "orf10")
unique_baits = paste('SARS-CoV2', unique_baits)
unique_baits = unique_baits[unique_baits%in%PPI_dat$Bait ]
unique_baits_cols = c()
i = 1
for(b in unique_baits[1:15]){
unique_baits_cols[b] = sequential("steelblue", percentage = 6, plot=F)[i]
i = i + 1
}
i = 1
for(b in unique_baits[16:18]){
unique_baits_cols[b] = sequential("red", percentage = 10, plot=F)[5+i]
i = i + 1
}
i = 1
for(b in unique_baits[19:26]){
unique_baits_cols[b] = sequential("green", percentage=10, plot=F)[2+i]
i = i+1
}
baits_withGene_ranks = intersect(as.character(PPI_dat %>% pull(PreyGene)), colnames(PPI_gene_ranks))
PPI_dat = PPI_dat %>% filter(PreyGene %in% baits_withGene_ranks)
PPI_dat$Bait = factor(PPI_dat$Bait, levels = names(unique_baits_cols))
PPI_dat = PPI_dat[order(PPI_dat$Bait), ]
PPI_gene_ranks = PPI_gene_ranks[,as.character(PPI_dat %>% pull(PreyGene))]
PPI_gene_ranks_baits = as.character(PPI_dat %>% pull(Bait))
PPI_gene_ranks_baits
PPI_gene_ranks
baits_withGene_ranks = intersect(as.character(PPI_dat %>% pull(PreyGene)), colnames(PPI_gene_ranks))
PPI_dat = read_csv(paste0(datadir_PPI, 'PPI_TableS2.csv'))
library(ComplexHeatmap)
library(circlize)
PPI_gene_ranks = read.table('results/PPI_results/Rank_median_in_tissues_corrected_for_COVs.csv', sep = ',',
header = T, stringsAsFactors = F)
PPI_gene_ranks = PPI_gene_ranks[order(rownames(PPI_gene_ranks)), ]
rownames(PPI_gene_ranks) = gtex_col$tissue_id
PPI_gene_ranks = PPI_gene_ranks[tissues_pass_lung,]
datadir_PPI = './PPI_data/'
PPI_dat = read_csv(paste0(datadir_PPI, 'PPI_TableS2.csv'))
library(colortools)
unique_baits = c(paste0("nsp", seq(1,5)), "nsp5_C145A",paste0("nsp", seq(6,15)),
"E", "M", "N",
"orf3a", "orf3b", "orf6", "orf7a", "orf7b", "orf8",
"orf9b", "orf9c", "orf10")
unique_baits = paste('SARS-CoV2', unique_baits)
unique_baits = unique_baits[unique_baits%in%PPI_dat$Bait ]
unique_baits_cols = c()
i = 1
for(b in unique_baits[1:15]){
unique_baits_cols[b] = sequential("steelblue", percentage = 6, plot=F)[i]
i = i + 1
}
i = 1
for(b in unique_baits[16:18]){
unique_baits_cols[b] = sequential("red", percentage = 10, plot=F)[5+i]
i = i + 1
}
i = 1
for(b in unique_baits[19:26]){
unique_baits_cols[b] = sequential("green", percentage=10, plot=F)[2+i]
i = i+1
}
baits_withGene_ranks = intersect(as.character(PPI_dat %>% pull(PreyGene)), colnames(PPI_gene_ranks))
PPI_dat = PPI_dat %>% filter(PreyGene %in% baits_withGene_ranks)
PPI_dat
unique(PPI_dat$Bait)
length(unique(PPI_dat$Bait))
PPI_dat = PPI_dat %>% filter(Bait != 'SARS-CoV2 Spike')
unique(PPI_dat$Bait)
PPI_dat$Bait = factor(PPI_dat$Bait, levels = names(unique_baits_cols))
PPI_dat = PPI_dat[order(PPI_dat$Bait), ]
PPI_gene_ranks = PPI_gene_ranks[,as.character(PPI_dat %>% pull(PreyGene))]
PPI_gene_ranks_baits = as.character(PPI_dat %>% pull(Bait))
ht_opt(
legend_title_gp = gpar(fontsize = 8, fontface = "bold"),
legend_labels_gp = gpar(fontsize = 8),
heatmap_column_names_gp = gpar(fontsize = 8),
heatmap_column_title_gp = gpar(fontsize = 10),
heatmap_row_title_gp = gpar(fontsize = 8)
)
bait_annotation = HeatmapAnnotation(bait = PPI_gene_ranks_baits,
col = list(bait = unique_baits_cols),
annotation_name_side = "left")
col_fun = colorRamp2(c(1, 25, 39, 49), c('red', 'yellow','cornflowerblue', 'white'))
ht = Heatmap(as.matrix(PPI_gene_ranks),
show_row_names =T,
show_row_dend = F,
show_column_dend = F,
show_column_names = F,
cluster_rows = T,
cluster_columns = F,
col = col_fun,
top_annotation = bait_annotation,
column_title = "SARS-CoV-2 genome components")
ht
col_fun = colorRamp2(c(1, 25, 49), c('red', 'white','cornflowerblue'))
ht = Heatmap(as.matrix(PPI_gene_ranks),
show_row_names =T,
show_row_dend = F,
show_column_dend = F,
show_column_names = F,
cluster_rows = T,
cluster_columns = F,
col = col_fun,
top_annotation = bait_annotation,
column_title = "SARS-CoV-2 genome components")
ht
ht = Heatmap(as.matrix(PPI_gene_ranks),
show_row_names =T,
show_row_dend = T,
show_column_dend = F,
show_column_names = F,
cluster_rows = T,
cluster_columns = T,
col = col_fun,
top_annotation = bait_annotation,
column_title = "SARS-CoV-2 genome components")
ht
ht = Heatmap(as.matrix(PPI_gene_ranks),
show_row_names =T,
show_row_dend = T,
show_column_dend = F,
show_column_names = F,
cluster_rows = T,
cluster_columns = F,
col = col_fun,
top_annotation = bait_annotation,
column_title = "SARS-CoV-2 genome components")
ht
col_fun = colorRamp2(c(1, 25, 49), c('red', 'white','cornflowerblue'))
ht = Heatmap(as.matrix(PPI_gene_ranks),
show_row_names =T,
show_row_dend = T,
show_column_dend = F,
show_column_names = F,
cluster_rows = T,
cluster_columns = T,
col = col_fun,
top_annotation = bait_annotation,
column_title = "SARS-CoV-2 genome components")
ht
ht = Heatmap(as.matrix(PPI_gene_ranks),
show_row_names =T,
show_row_dend = T,
show_column_dend = F,
show_column_names = F,
cluster_rows = T,
cluster_columns = T,
col = col_fun,
top_annotation = bait_annotation,
column_title = "SARS-CoV-2 genome components",
heatmap_legend_param = list(
title = "Gene expression Rank", at = c(1, 25, 49),
labels = c("1", "25", "49")
))
ht
ht = Heatmap(as.matrix(PPI_gene_ranks),
show_row_names =T,
show_row_dend = T,
show_column_dend = F,
show_column_names = F,
cluster_rows = T,
cluster_columns = F,
col = col_fun,
top_annotation = bait_annotation,
column_title = "SARS-CoV-2 genome components",
heatmap_legend_param = list(
title = "Gene expression Rank", at = c(1, 25, 49),
labels = c("1", "25", "49")
))
ht
